import{av as f}from"./weather-CCT19MCv.js";import{s as y}from"./main-BZ7YG8Tt.js";const I=r=>{let e="noChange";const{sceneType:s,originId:t}=r;let i=y.indoorSubsystem.currentFloor,o=i?i.name:"",n=y.sceneType;return s===1&&n===0?(e="inToOut",e):s===0&&n===1?(e="outToIn",e):s===1&&n===1||o===t?(e="noChange",e):s===0&&n===0&&t!==o&&t.slice(0,-3)===o.slice(0,-3)?(e="inToInSingle",e):(s===0&&n===0&&t!==o&&t.slice(0,-3)!==o.slice(0,-3)&&(e="inToInOther"),e)},k=r=>(r.map(e=>{const{coordinate:s,originId:t,sceneType:i}=e;e.position=f({coordinate:s,originId:t,sceneType:i})}),r),C=r=>{const{coordinate:e,id:s,name:t,originId:i,sceneType:o}=r;let n=i,a=f({coordinate:e,originId:i,sceneType:o}),c=!0;o===0&&!i.includes("F")&&(c=!1);let p=I({sceneType:o,originId:i});return{type:"inspection",sceneType:o,originId:n,id:s,filter:!0,sceneChangeType:p,inDoorModel:c,position:a,name:t}},M=r=>{const{coordinate:e,id:s,name:t,originId:i,sceneType:o,alarmTime:n}=r;let a=i,c=f({coordinate:e,originId:i,sceneType:o}),p=!0;o===0&&!i.includes("F")&&(p=!1);let l=I({sceneType:o,originId:i});return{type:"personDanger",sceneType:o,originId:a,id:s,filter:!0,sceneChangeType:l,inDoorModel:p,position:c,name:t,alarmTime:n}},E=r=>{let e=[];const{fenceData:s,originId:t,sceneType:i}=r;return s.map(o=>{let n={};n.originId=t,n.position=f({coordinate:o,originId:t,sceneType:i}),n.sceneType=i,e.push(n)}),e[0].position.equals(e[e.length-1].position)||e.push(e[0]),e},S=r=>{const{type:e,sceneType:s,originId:t,id:i,filter:o}=r;let n=!(s===0&&!t.includes("F")),a=I({sceneType:s,originId:t});return{type:e,sceneType:s,originId:t,id:i,filter:o,sceneChangeType:a,inDoorModel:n}},A=r=>{let{coordinate:e,id:s,deviceAlarm:t,users:i,level:o,name:n,originId:a,sceneType:c,radius:p}=r,l=f({coordinate:e,originId:a,sceneType:c}),g=I({sceneType:c,originId:a});return{sceneType:c,originId:a,id:s,sceneChangeType:g,position:l,name:n,users:i,level:o,radius:p,deviceAlarm:t}},h=r=>r!==null&&typeof r=="object"&&!Array.isArray(r)?[r]:r,O=r=>(r.forEach(e=>{let{originId:s,sceneType:t}=e,i=h(e.coordinate);e.position=[],i.forEach(o=>{e.position.push(f({coordinate:o,originId:s,sceneType:t}))})}),r),j=r=>{const{personList:e,indexList:s}=r;let t=new Map;e.forEach(o=>{const{name:n,id:a,type:c,tracks:p}=o;t.set(a,{name:n,id:a,type:c,tracks:new Map,newTracks:new Map}),p.map((l,g)=>{let{sceneType:d,originId:m,coordinate:u,index:T,dataTime:w}=l;g===0&&(t.get(a).firstIndex=T);let D=!b({sceneType:d,originId:m});l.visible=D,u?l.position=f({coordinate:u,originId:m,sceneType:d}):l.position={x:0,y:0,z:0},t.get(a).tracks.set(T,l)})});let i=new Map;return s.forEach(o=>{const{index:n,dataTime:a}=o;i.set(n,o),t.forEach(c=>{let p=c.tracks.get(n);if(p&&c.newTracks.set(n,p),!p)if(n<c.firstIndex){let l=c.tracks.get(c.firstIndex);c.newTracks.set(n,{visible:!1,index:n,dataTime:a,sceneType:l.sceneType,originId:l.originId,coordinate:l.coordinate,position:l.position})}else{let l=null,g=1/0;c.tracks.forEach((m,u)=>{if(u<=n){const T=n-u;T<g&&(g=T,l=u)}});let d=c.tracks.get(l);c.newTracks.set(n,{visible:d.visible,index:n,dataTime:a,sceneType:d.sceneType,originId:d.originId,coordinate:d.coordinate,position:d.position})}})}),t},b=r=>{let e=!1;const{sceneType:s,originId:t}=r;let i=y.indoorSubsystem.currentFloor,o=i?i.name:"",n=y.sceneType;return s===1&&n===1||o===t?(e=!1,e):(e=!0,e)};export{j as dangerHistoryData,E as doFenceData,k as equipData,A as gatherDangerDate,C as inspectionData,b as isSceneChange,M as personDangerData,O as realTimeData,I as sceneChange,S as searchData};
